# AI 성능 최적화 방안

## 현재 문제점 분석

### 1. 리소스 소모가 큰 이유
- **큰 모델 사용**: qwen2.5:14b (약 9GB 모델)
- **긴 프롬프트**: 커밋 메시지, 파일 경로 등 모든 상세 정보 포함
- **캐싱 없음**: 동일한 요청을 반복 처리
- **동기 처리**: 전체 응답을 기다려야 함

### 2. 현재 프롬프트 구조
- Task 제안: ~2000-3000 문자 (커밋 20개 + 이슈 + Task 목록)
- 진행도 분석: ~1500-2000 문자 (커밋 100개 통계)
- Task 완료 확인: ~1000-1500 문자 (커밋 메시지 전체)

## 개선 방안

### 1. 프롬프트 최적화 (우선순위: 높음)

#### A. 데이터 요약 및 필터링
- 커밋 메시지 요약 (핵심 키워드만 추출)
- 파일 경로 제거 또는 디렉토리 레벨로 요약
- 중복 정보 제거
- 통계 중심으로 변경

#### B. 프롬프트 템플릿 간소화
- 불필요한 설명 제거
- 구조화된 데이터 형식 사용 (JSON)
- 핵심 질문만 포함

### 2. 모델 선택 옵션 (우선순위: 중간)

#### A. 더 작은 모델 추가
- `qwen2.5:7b` (약 4.5GB) - 빠르고 효율적
- `qwen2.5:3b` (약 2GB) - 매우 빠름, 간단한 분석에 적합
- 모델 선택 옵션 제공

#### B. 작업 유형별 모델 선택
- 간단한 분석: 작은 모델
- 복잡한 분석: 큰 모델

### 3. 캐싱 전략 (우선순위: 높음)

#### A. 결과 캐싱
- 동일 프로젝트 + 동일 데이터 해시 → 캐시된 결과 반환
- TTL: 1시간 (커밋이 추가되면 무효화)
- Redis 또는 메모리 캐시 사용

#### B. 부분 캐싱
- 커밋 분석 결과 캐싱
- 이슈 분석 결과 캐싱

### 4. 비동기 처리 (우선순위: 중간)

#### A. 백그라운드 작업
- 긴 분석 작업을 큐에 추가
- 즉시 응답: "분석 중..." 상태 반환
- 완료 시 웹소켓 또는 폴링으로 결과 전달

### 5. 프롬프트 엔지니어링 개선 (우선순위: 높음)

#### A. Few-shot 예시 추가
- 예시를 통해 출력 형식 명확화
- 토큰 수 감소

#### B. 단계별 분석
- 1단계: 빠른 필터링 (규칙 기반)
- 2단계: AI 분석 (필요한 경우만)

## 구현 계획

### Phase 1: 즉시 적용 가능 (빠른 효과)
1. 프롬프트 최적화 - 데이터 요약
2. 더 작은 모델 옵션 추가
3. 프롬프트 템플릿 간소화

### Phase 2: 중기 개선
1. 캐싱 레이어 추가
2. 비동기 처리 구현

### Phase 3: 장기 개선
1. 스트리밍 응답
2. 모델 앙상블
3. 규칙 기반 전처리

